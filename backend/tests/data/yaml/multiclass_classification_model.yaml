name: multiclass_classification_model
framework: torch
dataset:
  name: Iris
  strategy: forwardArgs
  targetColumns:
    - name: species
      dataType:
        domainKind: categorical
        classes:
          0: 0
          1: 1
          2: 2
      outModule: Linear1
  featureColumns:
    - name: sepal_length
      dataType:
        domainKind: numeric
        unit: cm
    - name: sepal_width
      dataType:
        domainKind: numeric
        unit: cm
    - name: petal_length
      dataType:
        domainKind: numeric
        unit: cm
    - name: petal_width
      dataType:
        domainKind: numeric
        unit: cm

spec:
  layers:
    - name: Concat
      type: fleet.model_builder.layers.Concat
      constructorArgs:
        dim: 1
      forwardArgs:
        xs:
          - $sepal_length
          - $sepal_width
          - $petal_length
          - $petal_width

    - name: Linear0
      type: torch.nn.Linear
      constructorArgs:
        in_features: 4
        out_features: 128
      forwardArgs:
        input: $Concat

    - name: ReLU0
      type: torch.nn.ReLU
      constructorArgs:
        inplace: false
      forwardArgs:
        input: $Linear0

    - name: Linear1
      type: torch.nn.Linear
      constructorArgs:
        in_features: 128
        out_features: 3
      forwardArgs:
        input: $ReLU0
