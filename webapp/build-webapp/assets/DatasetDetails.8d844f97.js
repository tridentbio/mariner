import{j as e,az as i,P as v,f as n,bx as T,by as k,bz as p,bA as f,bB as E,F as u,l as o,L as c,Z as m,bc as g,ab as S,r as _,bo as I,bv as M,bC as j,h as O,a6 as R,C as D,k as z,bD as B,bE as P,aY as F,H as K}from"./index.5bdb0a85.js";import{C as L}from"./Container.c76c626f.js";const N=s=>{const t=()=>Object.keys(s.stats).map(a=>({name:a,...s.stats[a]})),d=()=>{const a=Object.keys(s.stats);return a.length?["name",...Object.keys(s.stats[a[0]]||{})]:["name"]};return s.stats?e(v,{sx:{overflowX:"auto"},children:n(T,{children:[e(k,{children:e(p,{children:d().map(a=>e(f,{children:a},a))})}),e(E,{children:t().map(a=>e(p,{children:d().map(r=>e(f,{children:r in a?s.replace&&s.replace(a[r])||a[r]:""},`${a.name}-${r}`))},a.name))})]})}):e(i,{children:"No metadata found for dataset..."})},U=(s,t,d)=>{let a="";return a+=`Columns errors:
`,s.forEach(r=>a+="	"+r+`
`),a+=`
Rows errors:
`,t.forEach(r=>a+="	"+r+`
`),d.length&&(a+=`
Other logs:
`,d.forEach(r=>a+="	"+r+`
`)),a+=`
You can see all errors found downloading the errors dataset`,a},V=s=>n(u,{children:[n(o,{sx:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingRight:5,mt:3},children:[e(c,{children:"Dataset Errors"}),e(m,{variant:"contained",color:"primary",onClick:()=>g(s.datasetId,s.errors.dataset_error_key||"dataset_with_errors.csv",!0),children:"Download dataset with errors"})]}),e(S,{message:"Failed to parse dataset (sample)",stackTrace:U(s.errors.columns,s.errors.rows,s.errors.logs)})]}),$=_.exports.lazy(()=>I(()=>import("./ModelEditorMarkdown.37ff2a5e.js"),["assets/ModelEditorMarkdown.37ff2a5e.js","assets/index.5bdb0a85.js","assets/index.32ed364a.css"])),A=s=>{const{data:t}=M({datasetId:parseInt(s.id)}),[d]=j(),a=O(),{setMessage:r}=R();if(!t)return e(D,{});const x=async()=>{const h=await d({datasetId:t.id});"data"in h&&h.data?(r({type:"success",message:"Deleted dataset"}),a("/datasets")):r({type:"error",message:"Failed to delete dataset"})},w=()=>{a(`/datasets/${t.id}/edit`)},b=h=>{const y={};for(const l of h)!l.dataType.domainKind||(y[l.pattern]={description:l.description,"data type":l.dataType.domainKind.toUpperCase(),unit:"unit"in l.dataType?l.dataType.unit:""});return y},C=()=>{a(`/models/new?datasetId=${t.id}`)};return n(L,{children:[n(o,{sx:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingRight:5},children:[e(c,{id:"dataset-name",maxWidth:"70%",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",children:t.name}),n("div",{children:[e(m,{onClick:C,variant:"contained",color:"primary",children:"New Model"}),e(m,{variant:"contained",color:"primary",sx:{ml:3},onClick:w,children:"Edit"}),e(m,{variant:"contained",color:"error",onClick:x,id:"delete-dataset",sx:{ml:3},children:"Delete"})]})]}),n(o,{sx:{display:"flex",flexDirection:"row",mt:5},children:[n(o,{sx:{mr:2},children:[e(i,{children:"CSV:"}),e(i,{children:"Rows:"}),e(i,{children:"Columns:"}),e(i,{children:"Size:"}),e(i,{children:"Split:"})]}),n(o,{children:[e(z,{onClick:()=>t.dataUrl&&g(t.id,t.dataUrl),children:e(i,{children:t.dataUrl})}),e(i,{children:t.rows||""}),e(i,{children:t.columns||""}),e(i,{children:t.bytes&&B(t.bytes)}),n(i,{id:"dataset-split",children:[t.splitTarget," (",t.splitType,")"]})]})]}),e(c,{mt:3,mb:3,children:"Dataset Overview"}),e("div",{id:"dataset-description",children:e($,{source:t.description,warpperElement:{"data-color-mode":"light"}})}),e(c,{children:"Column Descriptions"}),t.columnsMetadata&&e(N,{stats:b(t.columnsMetadata)}),t.readyStatus==="failed"&&t.errors&&e(V,{errors:t.errors,datasetId:t.id}),t.readyStatus==="ready"&&n(u,{children:[e(c,{mt:3,children:"Dataset Statistics"}),e(P,{columnsData:t.stats})]}),t.readyStatus==="processing"&&n(u,{children:[e(c,{mt:3,children:"Processing"}),e(o,{sx:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",mt:5},children:e(D,{sx:{mt:3},size:100})})]})]})},Y=()=>{const t=F("/datasets/:id");return e(K,{children:e(A,{id:t==null?void 0:t.params.id})})};export{Y as default};
