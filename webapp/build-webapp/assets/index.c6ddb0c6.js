import{e as N,j as n,ai as ue,aj as V,r as c,ak as ze,al as tt,am as nt,f as v,F as U,an as R,ao as rt,m as te,ap as Ae,T as He,aq as Q,ar as W,as as J,at as z,au as ot,av as at,I as ee,aw as st,ax as lt,B as ne,k as it,ay as ct,l as P,az as pe,aA as ge,aB as dt,aC as q,aD as ut,M as H,S as me,aE as fe,aF as pt,aG as K,aH as re,aI as ft,aJ as _e,aK as ht,aL as gt,aM as mt,aN as xt,aO as vt,aP as yt,Z as bt,aQ as Ct,aR as St,aS as Et,aT as wt}from"./index.5bdb0a85.js";import{R as Ot}from"./RemoveSharp.5e061972.js";const It=N(n("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward"),zt=N(n("path",{d:"m20 7 .94-2.06L23 4l-2.06-.94L20 1l-.94 2.06L17 4l2.06.94zM8.5 7l.94-2.06L11.5 4l-2.06-.94L8.5 1l-.94 2.06L5.5 4l2.06.94zM20 12.5l-.94 2.06-2.06.94 2.06.94.94 2.06.94-2.06L23 15.5l-2.06-.94zm-2.29-3.38-2.83-2.83c-.2-.19-.45-.29-.71-.29-.26 0-.51.1-.71.29L2.29 17.46c-.39.39-.39 1.02 0 1.41l2.83 2.83c.2.2.45.3.71.3s.51-.1.71-.29l11.17-11.17c.39-.39.39-1.03 0-1.42zm-3.54-.7 1.41 1.41L14.41 11 13 9.59l1.17-1.17zM5.83 19.59l-1.41-1.41L11.59 11 13 12.41l-7.17 7.18z"}),"AutoFixHighOutlined"),_t=N(n("path",{d:"M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z"}),"DeleteOutlined"),je=N(n("path",{d:"M4 20h16v2H4zM4 2h16v2H4zm5.41 11.59L8 15l4 4 4-4-1.41-1.41L13 15.17V8.83l1.59 1.58L16 9l-4-4-4 4 1.41 1.41L11 8.83v6.34z"}),"ExpandOutlined"),Tt=N(n("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1s1 .45 1 1v4c0 .55-.45 1-1 1zm1-8h-2V7h2v2z"}),"InfoRounded"),Lt=N(n("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVertRounded"),Mt=N(n("path",{d:"m6.83 11 1.59 1.59L7 14l-4-4 4-4 1.41 1.41L6.83 9H15c1.1 0 2 .9 2 2v9h-2v-9H6.83z"}),"TurnLeft");var Rt=function(t,o,a){return n("path",{stroke:a,strokeWidth:o,d:"M".concat(t/2," 0 V").concat(t," M0 ").concat(t/2," H").concat(t)})},Ft=function(t,o){return n("circle",{cx:t,cy:t,r:t,fill:o})},X;function Te(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),o.push.apply(o,a)}return o}function Le(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?Te(Object(o),!0).forEach(function(a){ue(e,a,o[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Te(Object(o)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(o,a))})}return e}var kt=(X={},ue(X,V.Dots,"#81818a"),ue(X,V.Lines,"#eee"),X),Dt=function(t){return t.transform},Be=function(t){var o=t.variant,a=o===void 0?V.Dots:o,i=t.gap,d=i===void 0?15:i,s=t.size,f=s===void 0?.4:s,m=t.color,u=t.style,r=t.className,l=c.exports.useRef(null),h=c.exports.useState(null),y=ze(h,2),g=y[0],I=y[1],T=tt(Dt),C=ze(T,3),j=C[0],_=C[1],F=C[2];c.exports.useEffect(function(){var A=document.querySelectorAll(".react-flow__background"),le=Array.from(A).findIndex(function(ie){return ie===l.current});I("pattern-".concat(le))},[]);var L=d*F||1,oe=j%L,w=_%L,ae=a===V.Lines,Y=m||kt[a],se=ae?Rt(L,f,Y):Ft(f*F,Y);return n("svg",{className:nt(["react-flow__background","react-flow__container",r]),style:Le(Le({},u),{},{width:"100%",height:"100%"}),ref:l,children:g&&v(U,{children:[n("pattern",{id:g,x:oe,y:w,width:L,height:L,patternUnits:"userSpaceOnUse",children:se}),n("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(g,")")})]})})};Be.displayName="Background";var Nt=c.exports.memo(Be);const At=[{value:1},{value:2},{value:3},{value:4},{value:5}],Ht=R.div`
  position: relative;
`,jt=R.div`
  border: solid 1px rgba(0, 0, 0, 0.1);
  width: 200px;
  position: absolute;
  top: 0;
  left: 27px;
  height: 95%;
  padding: 0 6px 0;
`,Bt=R(rt)({height:8,"& .MuiSlider-track":{border:"none"},"& .MuiSlider-thumb":{height:12,width:12,backgroundColor:"#fff",border:"2px solid currentColor","&:focus, &:hover, &.Mui-active, &.Mui-focusVisible":{boxShadow:"inherit"},"&:before":{display:"none"}},"& .MuiSlider-valueLabel":{lineHeight:1.2,fontSize:12,background:"unset",padding:0,width:32,height:32,borderRadius:"50% 50% 50% 0",backgroundColor:"#384E77",transformOrigin:"bottom left",transform:"translate(50%, -100%) rotate(-45deg) scale(0)","&:before":{display:"none"},"&.MuiSlider-valueLabelOpen":{transform:"translate(50%, -100%) rotate(-45deg) scale(1)"},"& > *":{transform:"rotate(45deg)"}}}),Me=({onAction:e,tooltipText:t,defaultInputValue:o,Icon:a,sliderOpen:i,setSliderState:d})=>{const s=c.exports.useRef(null),f=()=>{i||e(o),d()},m=r=>{e(r)},u=r=>{const l=s.current;!l||!r.target||l.contains(r.target)||d()};return c.exports.useEffect(()=>{if(!!i)return document.addEventListener("click",u),()=>{document.removeEventListener("click",u)}},[i]),n(te,{title:t,placement:"left",style:{fontSize:"8px"},children:v(Ht,{ref:s,children:[n(Ae,{about:t,onClick:f,children:n(a,{})}),i?v(jt,{children:[n(He,{sx:{fontSize:10,paddingLeft:1},variant:"subtitle2",children:"Space size"}),n(Bt,{"aria-label":"Restricted values",defaultValue:o,min:1,max:5,step:1,valueLabelDisplay:"auto",marks:At,sx:{padding:0},onChangeCommitted:(r,l)=>m(l)})]}):null]})})};var xe={},$t=W.exports;Object.defineProperty(xe,"__esModule",{value:!0});var $e=xe.default=void 0,Pt=$t(Q()),qt=J,Vt=(0,Pt.default)((0,qt.jsx)("path",{d:"M21 11V3h-8l3.29 3.29-10 10L3 13v8h8l-3.29-3.29 10-10z"}),"OpenInFull");$e=xe.default=Vt;var ve={},Kt=W.exports;Object.defineProperty(ve,"__esModule",{value:!0});var Pe=ve.default=void 0,Gt=Kt(Q()),Ut=J,Qt=(0,Gt.default)((0,Ut.jsx)("path",{d:"M22 3.41 16.71 8.7 20 12h-8V4l3.29 3.29L20.59 2 22 3.41zM3.41 22l5.29-5.29L12 20v-8H4l3.29 3.29L2 20.59 3.41 22z"}),"CloseFullscreen");Pe=ve.default=Qt;const Wt=({spacementMultiplierState:e,autoLayout:t,contentEditable:o=!0})=>{const{expandNodes:a,contractNodes:i}=z(),[d,s]=c.exports.useState(!0),[f,m]=c.exports.useState({horizontal:!1,vertical:!1}),[u,r]=e;return v(ot,{showInteractive:o,children:[n(Me,{onAction:l=>{t.vertical(l),r(l)},tooltipText:"Apply auto vertical layout",defaultInputValue:u,Icon:at,sliderOpen:f.vertical,setSliderState:()=>m(l=>({horizontal:!1,vertical:!l.vertical}))}),n(Me,{onAction:l=>{t.horizontal(l),r(l)},tooltipText:"Apply auto horizontal layout",defaultInputValue:u,Icon:It,sliderOpen:f.horizontal,setSliderState:()=>m(l=>({vertical:!1,horizontal:!l.horizontal}))}),n(te,{title:d?"Close all components":"Open all components",placement:"right",children:n(Ae,{about:d?"Close all components":"Open all components",onClick:()=>{d?i():a(),s(l=>!l)},children:d?n(Pe,{}):n($e,{})})})]})},he=e=>{const t={display:"flex",width:"30px",height:"30px",justifyContent:"center",alignItems:"center",...e.style||{}};return n(ee,{...e,style:t})};var ye={},Jt=W.exports;Object.defineProperty(ye,"__esModule",{value:!0});var qe=ye.default=void 0,Yt=Jt(Q()),Xt=J,Zt=(0,Yt.default)((0,Xt.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");qe=ye.default=Zt;const en=({html:e})=>(c.exports.useLayoutEffect(()=>{window.MathJax.Hub.Typeset()},[]),n("div",{dangerouslySetInnerHTML:{__html:e}}));const Ve=({docs:e,docsLink:t,commonIconProps:o})=>{var u;const[a,i]=c.exports.useState(null),d=r=>{i(r.currentTarget)},s=()=>{i(null)};c.exports.useEffect(()=>{var r,l;(l=(r=window.MathJax)==null?void 0:r.Hub)==null||l.Typeset()},[a]);const f=Boolean(a),m=f?"simple-popover":void 0;return v(U,{children:[n(te,{title:"Documentation",children:n(he,{onClick:d,className:"nodrag",children:n(Tt,{sx:{color:(u=st.palette)==null?void 0:u.primary.light},...o})})}),n(lt,{className:"Popover",id:m,open:f,anchorEl:a,onClose:s,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:v(ne,{sx:{p:2,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative"},children:[n(en,{html:e||""}),t&&n(it,{target:"_blank",href:t||"#",sx:{color:"white"},children:"Read More"}),n(he,{size:"large",onClick:s,sx:{position:"absolute",top:10,right:10},children:n(qe,{fontSize:"large",sx:{color:"white",width:"25px",height:"25px"},...o})})]})})]})},tn={cursor:"grab",p:1,width:"fit-content",border:"1px solid black",m:1,borderRadius:2},nn=["model_builder.featurizers.DNASequenceFeaturizer","model_builder.featurizers.RNASequenceFeaturizer","model_builder.featurizers.ProteinSequenceFeaturizer"],rn=({onDragStart:e,editable:t=!0})=>{const{data:o}=ct(),a=(o||[]).filter(r=>!nn.includes(r.classPath)),[i,d]=c.exports.useState(!1),s=()=>{d(r=>!r)},f=c.exports.useMemo(()=>(a==null?void 0:a.reduce((r,l)=>{const h=l.classPath.split(".")[0];return r[h]||(r[h]=[]),r[h].push(l),r},{}))||{},[a]),m=i?"0":"-450px",u=0;return v(P,{sx:{...t?{}:{display:"none"},position:"absolute",top:u,p:2,width:400,right:m,zIndex:200,borderRadius:2,boxShadow:"rgba(0,0,0,0.24) 0px 3px 8px",transition:"right 0.6s",backgroundColor:"white",display:"flex",flexDirection:"column"},children:[v(P,{sx:{display:"flex",alignItems:"center",flexDirection:"row"},children:[n(ee,{color:"primary",onClick:s,children:n(Ot,{})}),!i&&n(ee,{"data-testid":"openOptionsSidebarButton",color:"primary",sx:{zIndex:200,position:"absolute",right:450,top:u+100},onClick:()=>s(),children:n(Mt,{})}),n(pe,{children:"You can drag these nodes to the editor"})]}),n("div",{style:{display:"flex",flexDirection:"column"},children:Object.entries(f).map(([r,l],h)=>v(P,{children:[n(pe,{ml:2,fontSize:"1.2rem",fontWeight:"600",marginTop:"0.5rem",children:r==="model_builder"?"mariner".toUpperCase():r.toUpperCase()}),n(P,{children:n("div",{style:{flexDirection:"row",display:"flex",flexWrap:"wrap"},children:l.map(y=>v(P,{sx:tn,draggable:!0,onDragStart:g=>{e({event:g,data:y})},children:[ge(y.classPath,"."),n(Ve,{commonIconProps:{fontSize:"small"},docs:y.docs,docsLink:y.docsLink||""})]},y.classPath))})})]},r))})]})},be=e=>{const{expandedNodesMap:t}=z(),o=t[e.id];return v("div",{children:[e.headerExtra&&n("div",{className:"header",children:e.headerExtra}),v("div",{className:"content",children:[n(pe,{fontSize:20,fontWeight:"bold",children:e.title}),e.handlesElement,e.children&&n("div",{style:{marginTop:10,height:o?"fit-content":0,transition:"height 1s",display:"flex",overflow:"hidden",flexDirection:"column"},children:e.children})]})]})};var Ke=(e=>(e.INT_REQUIRED="<class 'int'>",e.INT_OPTIONAL="<class 'int'>?",e.STR_REQUIRED="<class 'str'>",e.STR_OPTIONAL="<class 'str'>?",e.BOOL_REQUIRED="<class 'bool'>",e.BOOL_OPTIONAL="<class 'bool'>?",e.TORCH_TENSOR_REQUIRED="<class 'torch.Tensor'>",e.TORCH_TENSOR_OPTIONAL="<class 'torch.Tensor'>?",e.TORCH_GEOMETRIC_DATA_REQUIRED="<class 'torch_geometric.data.data.Data'>",e))(Ke||{});const on="250px",Ce=e=>{const{total:t,order:o,nodeId:a,required:i,...d}=e,{getHandleKey:s}=z(),f=s(a,d.type,d.id||"");return v(dt,{...d,style:{height:10,width:10,backgroundColor:i?"black":"lightgrey",left:`calc(${on} * ${(o+1)/(t+1)} )`},children:[n(He,{sx:{top:o%2==0?"-20px":"8px",position:"relative",fontFamily:"monospace",fontSize:10},children:d.id}),f&&n("div",{style:{backgroundColor:"#2e332f",padding:10,top:"-80px",position:"relative",color:"white",borderRadius:3,textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center"},children:f})]})},an=e=>{const{options:t}=z(),o=()=>{const{type:s,nodeId:f}=e;if(!s)return[];if(!t||!(s in t))return[];const m=t[s].component;return Object.keys(m.forwardArgsSummary||{}).map((u,r,l)=>({nodeId:f,type:"target",id:u,position:q.Top,isConnectable:!0,order:r,total:l.length}))},a=()=>{const{type:s,nodeId:f}=e;return s?!t||!(s in t)?[]:t[s].outputType===Ke.TORCH_GEOMETRIC_DATA_REQUIRED?["x","edge_index","edge_attr","batch"].map((u,r,l)=>({nodeId:f,id:u,type:"source",position:q.Bottom,isConnectable:!0,order:r,total:l.length})):[{nodeId:f,type:"source",id:"",position:q.Bottom,isConnectable:!0,order:0,total:1}]:[]},i=o(),d=a();return n(U,{children:i.concat(d).map(s=>c.exports.createElement(Ce,{...s,key:s.id}))})},Ge=e=>{const[t,o]=c.exports.useState(null),a=Boolean(t),i=s=>{o(s.currentTarget)},d=()=>{o(null)};return v("div",{onMouseLeave:d,children:[n(he,{id:"basic-button","aria-controls":a?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":a?"true":void 0,onClick:i,children:n(Lt,{})}),n(ut,{id:"basic-menu",anchorEl:t,open:a,onClose:d,MenuListProps:{"aria-labelledby":"basic-button",onMouseLeave:d},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},children:e.options.map(s=>n(H,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},onClick:s.onClick,children:n(te,{title:s.tip,children:s.icon})},s.key))})]})},sn=({onChange:e,onBlur:t,validate:o,value:a,...i})=>{const[d,s]=c.exports.useState(a),[f,m]=c.exports.useState(),u=r=>{e&&e(r);let l=r.target.value;i.type==="number"&&(l=r.target.value),s(l.toString())};return c.exports.useEffect(()=>{d!==a&&s(a)},[a]),c.exports.useEffect(()=>{if(o){const r=o(d);m(r?"green":"red")}},[d]),n(me,{...i,onChange:u,onBlur:t,value:d,inputProps:{style:{color:f},...i.inputProps||{}}})},ln=e=>{const[t,o]=c.exports.useState(!1),{editable:a,errors:i,editConstrutorArgs:d,option:s}=e,f=()=>{o(!0)},m=()=>{o(!1)},u=c.exports.useRef(null);return!(s!=null&&s.argsOptions)||!(e.argKey in s.argsOptions)?null:(c.exports.useEffect(()=>{u&&u.current&&a&&u.current.addEventListener("mousedown",()=>{o(r=>!r)})},[]),n(me,{sx:{mb:2,width:"100%"},value:e.value||"",onChange:r=>{d(e.argKey,r.target.value)},error:e.argKey in i,label:i[e.argKey]||e.argKey,disabled:!a,select:!0,SelectProps:{open:t,onOpen:f,onClose:m,ref:u,sx:{mb:2,width:"80%",maxHeight:60,fontSize:16,py:-5,color:"grey.600",zIndex:100}},children:s.argsOptions[e.argKey].map(r=>n(H,{value:r,children:r},r))},e.argKey))},Re=e=>e.includes("str"),cn=e=>e.includes("int")||e.includes("float"),dn=e=>e.includes("bool"),un=({editable:e,...t})=>{const{options:o,editComponent:a,schema:i,suggestionsByNode:d}=z();if(!o)return null;const s=o[t.data.type];if(!s||!s.component.constructorArgsSummary)return null;const f=(r,l)=>i&&!a({schema:i,data:K({component:re(i,t.data.name),constructorArgs:{[r]:l},options:o})}),u=(d[t.data.name]||[]).reduce((r,l)=>({...r,...l.getConstructorArgsErrors()}),{});return n("div",{style:{marginTop:5},children:Object.entries(s.component.constructorArgsSummary).map(([r,l])=>!("constructorArgs"in t.data)||!(r in t.data.constructorArgs)?null:Re(l)&&!!s.argsOptions&&s.argsOptions[r]?n(ln,{editable:e,option:s,argKey:r,editConstrutorArgs:f,errors:u,value:t.data.constructorArgs[r]||""},r):Re(l)?n(me,{sx:{mb:2},onBlur:h=>f(r,h.target.value),error:r in u,label:u[r]||r,disabled:!e},r):cn(l)?n(sn,{type:"number",inputMode:"numeric",sx:{mb:2},value:t.data.constructorArgs[r],onBlur:h=>f(r,parseFloat(h.target.value)),error:r in u,label:u[r]||r,disabled:!e,inputProps:{step:"0.0001"}},r):dn(l)?v(ne,{sx:{marginBottom:1},children:[n(fe,{error:r in u,id:`label-${r}`,children:u[r]||r}),n(pt,{id:r,className:"nodrag",defaultChecked:t.data.constructorArgs[r],onChange:h=>f(r,h.target.checked),disabled:!e})]},r):null).filter(r=>!!r)})},Fe=({editable:e=!0,...t})=>{const{options:o,deleteComponents:a,schema:i,toggleExpanded:d}=z(),s=(o||{})[t.data.type],{docs:f,docsLink:m}=s||{};return n(be,{title:ge(t.data.type,"."),docs:f,docsLink:m,id:t.id,handlesElement:n(an,{nodeId:t.data.name,type:t.data.type}),headerExtra:n(Ge,{options:[{icon:n(Ve,{docs:f,docsLink:m}),onClick:()=>null,tip:"Documentation"},{icon:n(je,{fontSize:"small",width:"25px",height:"25px"}),onClick:()=>d(t.id),tip:"Expand"},{icon:n(_t,{fontSize:"small",width:"25px",height:"25px"}),onClick:()=>i&&a({schema:i,nodeId:t.data.name}),tip:"Delete"}].map((u,r)=>({...u,key:r.toString()}))}),children:n(un,{data:t.data,editable:e})})},pn=e=>n(be,{id:e.id,title:e.data.name,handlesElement:n(Ce,{nodeId:e.data.name,total:1,order:0,type:"source",position:q.Bottom})}),fn=({editable:e})=>!e&&`
  svg {
    display: none;
  }
  #mui-component-select-taskType {
    padding-right: 14px;
  }
  #mui-component-select-lossFunction {
    padding-right: 14px;
  }
`,hn=R.div`
  margin-top: 5;
  ${fn}
`,G={binClass:"binary",mcClass:"multiclass",regr:"regression"},gn=Object.entries(G).reduce((e,[t,o])=>({...e,[o]:t}),{}),mn=e=>e&&e!=="typeMap"&&G[e]&&G[e].replace(/./,t=>t.toUpperCase())||"",xn=e=>e.domainKind==="categorical"?Object.keys(e.classes).length===2?"binClass":"mcClass":"regr",vn=({editable:e,name:t})=>{const{editComponent:o,schema:a}=z(),i=c.exports.useMemo(()=>a&&re(a,t),[a,t]),[d,s]=c.exports.useState([!1,!1]),f=[c.exports.useRef(null),c.exports.useRef(null)],{data:m}=ft(),[u,r]=c.exports.useState();c.exports.useEffect(()=>{e?i&&!u&&r(xn(i.dataType)):i&&i.columnType&&r(gn[i.columnType])},[i]);const l=c.exports.useMemo(()=>!m||!u?[]:m[u],[m,u]),[h,y]=c.exports.useState();return c.exports.useEffect(()=>{e?l.length&&y(l[0]):i&&i.lossFn&&y(l.find(g=>g.key===i.lossFn))},[l]),c.exports.useEffect(()=>{e&&a&&i&&o({schema:a,data:K({component:i,lossFn:h==null?void 0:h.key,columnType:u&&u!=="typeMap"&&G[u]||void 0})})},[h,u]),c.exports.useEffect(()=>{f.forEach((g,I)=>{g&&g.current&&e&&g.current.addEventListener("mousedown",()=>{s(T=>{const C=[...T];return C[I]=!C[I],C})})})},[]),v(hn,{editable:e,children:[n(fe,{children:"Task Type"}),n(_e,{sx:{mb:2,width:"80%",maxHeight:60,fontSize:16,py:-5,color:"grey.600",zIndex:100},ref:f[0],onChange:({target:g})=>{r(g.value)},open:d[0],onClose:()=>s(g=>[!1,g[1]]),value:u||"",name:"taskType",children:Object.keys(G).map(g=>n(H,{value:g,children:mn(g)},g))}),n(fe,{children:"Loss Function"}),n(_e,{sx:{mb:2,width:"80%",maxHeight:60,fontSize:16,py:-5,color:"grey.600",zIndex:100},onChange:({target:g})=>{const I=l.find(T=>T.key===g.value);y(I)},open:d[1],onClose:()=>s(g=>[g[0],!1]),ref:f[1],value:(h==null?void 0:h.value)||"",name:"lossFunction",children:l.map(g=>n(H,{value:g.value,children:g.value},g.key))})]})},yn=({editable:e=!0,...t})=>{const{toggleExpanded:o}=z();return n(be,{id:t.id,title:t.data.name,headerExtra:n(Ge,{options:[{icon:n(je,{fontSize:"small",width:"25px",height:"25px"}),onClick:()=>o(t.id),tip:"Expand"}].map((a,i)=>({...a,key:i.toString()}))}),handlesElement:n(Ce,{nodeId:t.data.name,id:"",total:1,order:0,type:"target",position:q.Top}),children:n(vn,{editable:e,name:t.data.name})})},bn=.5,Cn=e=>{const{setCenter:t,getNode:o,getEdge:a,applySuggestions:i,schema:d,expandNodes:s}=z(),f=l=>{mt.isNodeSchema(l.context)&&s([l.context.nodeId]);const h=xt(l.context,{getNode:o,getEdge:a});!h||t(h.x,h.y,{zoom:bn,duration:1e3})},m={ERROR:"error",WARNING:"warning",IMPROV:"info"},u=e.suggestions.filter(l=>l.commands.length>0),r=()=>{d&&i({suggestions:e.suggestions,schema:d})};return n(ne,{children:(u.length>1?[n(H,{onClick:r,children:"Fix all"},"fix all")]:[]).concat(e.suggestions.map((l,h)=>v(H,{onClick:()=>f(l),children:[n(ht,{color:m[l.severity],icon:n(gt,{}),children:l.message}),n(ee,{onClick:y=>{y.stopPropagation(),d&&i({suggestions:[l],schema:d})},children:n(zt,{})})]},`sugg-${h}`)))})},Sn=R.div`
  background: transparent;
  width: 60px;
  height: 60px;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 60px;
  margin: 0;
  display: ${({editable:e=!1})=>e?"unset":"none"};
`,En=R.button`
  width: 30px;
  height: 30px;
  background: #e5e5e5;
  border: 1px solid #fff;
  cursor: pointer;
  border-radius: 50%;
  font-size: 16px;
  line-height: 1;
  color: #000;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 0;
  &:hover {
    box-shadow: 0 0 6px 2px rgba(0, 0, 0, 0.08);
  }
`,Z=60,wn=({editable:e=!0,...t})=>{const{id:o,style:a,markerEnd:i,sourceX:d,sourceY:s,targetX:f,targetY:m,sourcePosition:u,targetPosition:r,target:l,targetHandleId:h,sourceHandleId:y}=t,g=vt({sourceX:d,sourceY:s,sourcePosition:u,targetX:f,targetY:m,targetPosition:r}),[I,T]=yt({sourceX:d,sourceY:s,targetX:f,targetY:m}),{suggestionsByEdge:C,editComponent:j,schema:_,options:F}=z();return v(U,{children:[n("path",{id:o,style:{...a||{},stroke:o in C?"red":void 0},className:"react-flow__edge-path",d:g,markerEnd:i}),n("foreignObject",{width:Z,height:Z,x:I-Z/2,y:T-Z/2,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml",children:n(Sn,{editable:e,children:n(En,{onClick:L=>{_&&F&&j({schema:_,data:K({component:re(_,l),options:F,removeConnection:{targetNodeForwardArg:h||"",elementValue:y||void 0}})})},children:"\xD7"})})})]})},On=R.div`
  .model_editor_error {
    stroke: rgba(255, 0, 0, 0.2);
  }
  .react-flow__node {
    border: 1px solid #cccccc;
    background: white;
    min-width: 250px;
    padding: 3px;
    display: flex;
    flex-direction: column;
    text-align: center;
    width: 250px;
    box-sizing: border-box;
    border-radius: 3px;

    .header {
      position: absolute;
      right: 0;
      top: 0;
      display: flex;
      flex-direction: row;
      justify-content: flex-end;
    }
    .content {
      margin-top: 10px;
      margin-bottom: 10px;
    }
  }
  .react-flow__node-layer,
  react-flow__node-featurizer {
  }
`;var E={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5,fullscreen:6},ke=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],De=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],Ne=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"],b=typeof window<"u"&&typeof window.document<"u"?window.document:{},O="fullscreenEnabled"in b&&Object.keys(E)||ke[0]in b&&ke||De[0]in b&&De||Ne[0]in b&&Ne||[],In={requestFullscreen:function(e){return e[O[E.requestFullscreen]]()},requestFullscreenFunction:function(e){return e[O[E.requestFullscreen]]},get exitFullscreen(){return b[O[E.exitFullscreen]].bind(b)},get fullscreenPseudoClass(){return":"+O[E.fullscreen]},addEventListener:function(e,t,o){return b.addEventListener(O[E[e]],t,o)},removeEventListener:function(e,t,o){return b.removeEventListener(O[E[e]],t,o)},get fullscreenEnabled(){return Boolean(b[O[E.fullscreenEnabled]])},set fullscreenEnabled(e){},get fullscreenElement(){return b[O[E.fullscreenElement]]},set fullscreenElement(e){},get onfullscreenchange(){return b[("on"+O[E.fullscreenchange]).toLowerCase()]},set onfullscreenchange(e){return b[("on"+O[E.fullscreenchange]).toLowerCase()]=e},get onfullscreenerror(){return b[("on"+O[E.fullscreenerror]).toLowerCase()]},set onfullscreenerror(e){return b[("on"+O[E.fullscreenerror]).toLowerCase()]=e}};const M=In;function zn(){var e=c.exports.useState(!1),t=e[0],o=e[1],a=c.exports.useRef(null);c.exports.useEffect(function(){var s=function(){o(M.fullscreenElement===a.current)};return M.addEventListener("fullscreenchange",s),function(){return M.removeEventListener("fullscreenchange",s)}},[]);var i=c.exports.useCallback(function(){if(M.fullscreenElement)return M.exitFullscreen().then(function(){return M.requestFullscreen(a.current)});if(a.current)return M.requestFullscreen(a.current)},[]),d=c.exports.useCallback(function(){return M.fullscreenElement===a.current?M.exitFullscreen():Promise.resolve()},[]);return c.exports.useMemo(function(){return{active:t,enter:i,exit:d,node:a}},[t,i,d])}var _n=function(t){var o=t.handle,a=t.onChange,i=t.children,d=t.className,s=[];return d&&s.push(d),s.push("fullscreen"),o.active&&s.push("fullscreen-enabled"),c.exports.useEffect(function(){a&&a(o.active,o)},[o.active]),n("div",{className:s.join(" "),ref:o.node,style:o.active?{height:"100%",width:"100%"}:void 0,children:i})},Se={},Tn=W.exports;Object.defineProperty(Se,"__esModule",{value:!0});var Ue=Se.default=void 0,Ln=Tn(Q()),Mn=J,Rn=(0,Ln.default)((0,Mn.jsx)("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"}),"Fullscreen");Ue=Se.default=Rn;var Ee={},Fn=W.exports;Object.defineProperty(Ee,"__esModule",{value:!0});var Qe=Ee.default=void 0,kn=Fn(Q()),Dn=J,Nn=(0,kn.default)((0,Dn.jsx)("path",{d:"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"}),"FullscreenExit");Qe=Ee.default=Nn;const An=R.div`
  position: relative;

  .full-screen-button {
    position: absolute;
    top: ${({fullScreen:e})=>e?"unset":"75vh"};
    right: 0;
    bottom: ${({fullScreen:e})=>e?"1rem":"unset"};
    right: 0;
    z-index: 100;
  }
  .fullscreen-enabled {
    background: white;
  }

  section {
    position: absolute;
    right: 50vw;
    bottom: 2rem;
  }
`,Hn=({children:e,fullScreen:t,setFullScreen:o})=>{const a=zn();return c.exports.useEffect(()=>{t?a.enter():a.exit()},[t]),n(An,{fullScreen:t,children:n(_n,{handle:a,children:v(U,{children:[n(bt,{onClick:()=>o(!t),className:"full-screen-button",children:t?n(Qe,{}):n(Ue,{})}),e]})})})},jn=e=>e<3?8:e<5?6:e<7?3:1,Bn=e=>new Promise(t=>setTimeout(t,e)),qn=({value:e,onChange:t,editable:o=!0})=>{const{applyDagreLayout:a,editComponent:i,addComponent:d,project:s,nodes:f,edges:m,setNodes:u,setEdges:r,schemaToEditorGraph:l,schema:h,setSchema:y,suggestions:g,getSuggestions:I,assignPositionsOrdering:T,keyAssignments:C,clearPositionOrdering:j,options:_,fitView:F}=z(),[L,oe]=c.exports.useState(!1),[w,ae]=c.exports.useState(),Y=c.exports.useMemo(()=>({layer:p=>n(Fe,{editable:o,...p}),featurizer:p=>n(Fe,{editable:o,...p}),input:p=>n(pn,{...p}),output:p=>n(yn,{...p,editable:o})}),[o]),se=c.exports.useMemo(()=>({ModelEdge:p=>n(wn,{editable:o,...p})}),[o]);c.exports.useEffect(()=>{e&&y(e)},[]);const A=c.exports.useRef(null),[le,ie]=c.exports.useState(!1);c.exports.useEffect(()=>{if(!A.current)return;const[p,x]=l(e);o?(u(p.reverse()),r(x),I({schema:e}),a("TB",jn(p.length))):(u(p),r(x),I({schema:e}),a("TB",3,x))},[]);const We=c.exports.useCallback(async()=>{await Bn(50),ie(!0)},[]);c.exports.useEffect(()=>{We()},[f.length>0]),c.exports.useEffect(()=>{F()},[le]),c.exports.useEffect(()=>{t&&h&&t(h)},[h]);const Je=p=>{p.preventDefault(),p.dataTransfer.dropEffect="move"},[Ye,Xe]=c.exports.useState(0),Ze=p=>{if(!A.current)return;const x=JSON.parse(p.dataTransfer.getData("application/componentData")),S=JSON.parse(p.dataTransfer.getData("application/offset")),{type:k}=x.component,{type:B}=x;if(!k)return;const D=A.current.getBoundingClientRect(),$=s({x:p.clientX-D.left-S.x,y:p.clientY-D.top-S.y});d({schema:e,name:`${ge(k,".")}-${Ye}`,type:k,componentType:B},$),Xe(ce=>ce+1)},[we,et]=c.exports.useState(!1),Oe=p=>{var Ie;if(!we||!C)return;const x=C.find(({key:de})=>de===p.key);if(!x)return;const S=(Ie=f.find(de=>de.id===x.nodeId))==null?void 0:Ie.data;if(!S||!_||!h)return;let k,B,D,$;if((w==null?void 0:w.handleType)==="source")k=w.component,B=w.handleId||"",D=S,$="targetHandleId"in x?x.targetHandleId:"";else if((w==null?void 0:w.handleType)==="target")D=w.component,$=w.handleId||"",k=S,B="sourceHandleId"in x?x.sourceHandleId:"";else return;if(D.type==="input")return;const ce=K({component:D,forwardArgs:{sourceComponentName:k.name,sourceComponentOutput:B,targetNodeForwardArg:$},options:_});i({schema:h,data:ce})};return c.exports.useLayoutEffect(()=>(window.addEventListener("keydown",Oe),()=>{window.removeEventListener("keydown",Oe)}),[we,C]),n(Hn,{fullScreen:L,setFullScreen:oe,children:v(On,{children:[v(ne,{ref:A,style:{flex:"grow",left:0,height:L?"100vh":"80vh",border:"1px solid black",overflow:"hidden"},children:[v(Ct,{nodes:f,edges:m,nodeTypes:Y,edgeTypes:se,minZoom:.1,onDragOver:Je,onDrop:Ze,onNodesChange:p=>{u(x=>St(p,x))},onEdgesChange:p=>r(x=>Et(p,x)),onConnectEnd:()=>{j()},onConnectStart:(p,x)=>{if(!h)return;if(!x.handleType)return console.warn('No "handleId" in connectionParams of onConnectStartEvent');if(!x.nodeId)return console.warn('No "nodeId" in connectionParams of onConnectStartEvent');const S=wt(h,x.nodeId);if(!S)return console.warn(`No component named ${x.nodeId} in schema`);ae({component:S,handleId:x.handleId,handleType:x.handleType}),S&&(T(x.handleType,S),et(!0))},onConnect:p=>{if(!p.source||!p.target||!_||!h)return;const x=re(h,p.target);if(!x)return;const S=K({component:x,forwardArgs:{targetNodeForwardArg:p.targetHandle||"",sourceComponentName:p.source,sourceComponentOutput:p.sourceHandle||void 0},options:_});return i({schema:e,data:S})},children:[n(Nt,{color:"#384E77",variant:V.Dots}),n(Wt,{spacementMultiplierState:[0,()=>{}],contentEditable:o,autoLayout:{vertical:p=>a("TB",p),horizontal:p=>a("LR",p)}})]}),o&&n(rn,{onDragStart:({event:p,data:x})=>{p.dataTransfer.setData("application/reactflow","ComponentConfigNode"),p.dataTransfer.setData("application/componentData",JSON.stringify(x)),p.dataTransfer.setData("application/offset",JSON.stringify({x:p.clientX-p.currentTarget.getBoundingClientRect().x,y:p.clientY-p.currentTarget.getBoundingClientRect().y})),p.dataTransfer.effectAllowed="move"},editable:o})]}),n("div",{children:(g==null?void 0:g.length)>0&&n(Cn,{suggestions:g})})]})})};export{he as I,qn as M};
