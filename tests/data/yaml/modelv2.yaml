name: GNNExample
dataset:
  name: Small Zinc dataset
  targetColumn: 
    name: tpsa
    dataType:
      domainKind: smiles
  featureColumns:
    - name: smiles
      dataType:
        domainKind: smiles
    - name: mwt
      dataType:
        domainKind: numeric
  featurizers:
    - name: MolToGraphFeaturizer
      type: app.features.model.featurizers.MoleculeFeaturizer
      forwardArgs:
        - smiles
      constructorArgs:
        allow_unknown: false
        sym_bond_list: true
        per_atom_fragmentation: false
layers:
  # Start fst branch (from featurizer)
  - name: GCN1
    type: torch_geometric.nn.GCNConv
    constructorArgs:
      in_channels: 26
      out_channels: 64
    forwardArgs:
        x: MolToGraphFeaturizer.x
        edge_attr: MolToGraphFeaturizer.edge_attr
        edge_index: MolToGraphFeaturizer.edge_index
  - name: GCN1_Activation
    type: torch.nn.ReLU
    forwardArgs: GCN1
  - name: GCN2 
    type: torch_geometric.nn.GCNConv
    forwardArgs: 
      x: GCN1_Activation
      edge_index: MoltoGraphFeaturizer.edge_index
      edge_attr: MolToGraphFeaturizer.edge_attr
    constructorArgs:
      in_channels: 64
      out_channels: 64
  - name: GCN2_Activation
    type: torch.nn.ReLU
    forwardArgs: GCN2
  - name: GCN3
    type: torch_geometric.nn.GCNConv
    constructorArgs:
      in_channels: 64
      out_channels: 64
    forwardArgs:
      x: GCN2_Activation
      edge_index: MolToGraphFeaturizer.edge_index
      edge_attr: MolToGraphFeaturizer.edge_attr

  - name: GCN3_Activation
    type: torch.nn.ReLU
    forwardArgs: GCN3

  - name: AddPool
    type: app.features.model.layers.GlobalPooling
    forwardArgs: 
      x: GCN3_Activation
      edge_index: MoltoGraphFeaturizer.edge_index
      edge_attr: MolToGraphFeaturizer.edge_attr
    constructorArgs:
      aggr: 'sum'
  # End of fst branch
  # Second branch would simply be linear layers in mwt
  - name: Linear1
    type: torch.nn.Linear
    constructorArgs:
      in_features: 1
      out_features: 10
    forwardArgs: mwt
  - name: Combiner
    type: app.features.model.layers.Concat
    forwardArgs: ['AddPool', 'Linear1']
  - name: LinearJoined
    type: torch.nn.Linear
    forwardArgs: Combiner
    constructorArgs:
      in_features: 74
      out_features: 1
