name: DnaExampleModel
dataset:
  name: Dna Example Dataset
  featureColumns:
    - name: sequence
      dataType:
        domainKind: dna
  targetColumn:
    name: " class"
    dataType:
      domainKind: categorical
      classes:
        0: 1
        1: 2
        2: 3
        3: 4
        4: 5
        5: 6
        6: 7
layers:
  - name: embeddings
    type: torch.nn.Embedding
    constructorArgs:
      num_embeddings: 5
      embedding_dim: 16
      padding_idx: 0
    forwardArgs:
      input: $sequence

  - name: transformer 1 
    type: torch.nn.TransformerEncoderLayer
    constructorArgs:
      d_model: 16
      nhead: 4
      dim_feedforward: 128
      dropout: 0.1
    forwardArgs:
      src: $sequence

  - name: transformer 2
    type: torch.nn.TransformerEncoderLayer
    constructorArgs:
      d_model: 16
      nhead: 4
      dim_feedforward: 128
      dropout: 0.1
    forwardArgs:
      src: ${transformer 1}
  - name: sequence pooling
    type: model_builder.layers.AddPooling
    constructorArgs:
      dim: 0
    forwardArgs:
      x: ${transformer 2}
  - name: linear 1
    type: torch.nn.Linear
    constructorArgs:
      in_features: 16
      out_features: 32
    forwardArgs:
      input: ${transformer sequence pooling}
  - name: activation linear 1
    type: torch.nn.ReLU
    constructorArgs:
      inplace: False
    forwardArgs:
      input: ${linear 1}
  - name: linear 2
    type: torch.nn.Linear
    constructorArgs:
      in_features: 32
      out_features: 1
    forwardArgs:
      input: ${activation linear 1}
